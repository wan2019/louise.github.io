<html>
<head>
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=big5">
<script
  src="https://code.jquery.com/jquery-3.4.1.js"
  integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU="
  crossorigin="anonymous"></script>
</head>

<body>
<h2 align=center>動態下拉式選單：三框連動（三層樹狀選項）</h2>
<hr>
<form name="theForm">
<table align=center border=1>
	<tr>
		<th>歌曲語言<th>歌星名字<th>歌曲清單
	<tr>
		<td align=center>
			<select name="column1" id="no1" onChange="onChangeColumn1();"></select>
		<td align=center>
			<select name="column2" onChange="onChangeColumn2();">
			</select>
		<td align=center>
			<select name="column3"  onChange="onChangeColumn3();">
			</select>
	<tr><td colspan=3 align=center>路徑：<input type=text name=path size=60></td></tr>
</table>
</form>

<hr>
<script>
	function node(name, child){
	this.name=name;
	this.child=child;
}

function dataHierarchy(){
	// 國語歌手
	var mandarin=new Array();
	var i=0;
	mandarin[i++]=new node("張學友", ["我等到花兒也謝了", "一千個傷心的理由", "咖啡"]);
	mandarin[i++]=new node("張惠妹", ["聽海", "剪愛", "原來你什麼都不要", "三天三夜"]);
	mandarin[i++]=new node("劉德華", ["謝謝你的愛", "來生緣", "忘情水"]);
	mandarin[i++]=new node(  "伍佰", ["浪人情歌", "樹枝孤鳥"]);
	mandarin[i++]=new node("周華健", ["花心", "心的方向"]);
	// 英語歌手
	alert(mandarin[0].name);
	alert(mandarin[0].child[0]);
	var english=new Array();
	var i=0;
	english[i++]=new node("Michael", ["Beat It", "Billie Jean", "Heal The World"]);
	english[i++]=new node("Celine", ["My Heart Will Go On", "Hope"]);
	// 語言類別
	var output=new Array();
	var i=0;
	output[i++]=new node("國語", mandarin);
	output[i++]=new node("英語", english);

	return(output);
}
dataTree=dataHierarchy();
console.log(dataTree);

$('#no1').change(function(){
	var content;
	for (i=0; i<dataTree.length; i++){
	content = content + '<option>'+dataTree[i].name+ '</option>'
	}
$('#no1').html(content);
});
$('#no1').change();

// 第二個欄位被更動後的反應動作
function onChangeColumn2(){
	form=document.theForm;
	index1=form.column1.selectedIndex;
	index2=form.column2.selectedIndex;
	index3=form.column3.selectedIndex;
	

	// Create options for column 3
	for (i=0;i<dataTree[index1].child[index2].child.length;i++)
		form.column3.options[i]=new Option(dataTree[index1].child[index2].child[i], dataTree[index1].child[index2].child[i]);
	form.column3.options.length=dataTree[index1].child[index2].child.length;
}

// 第一個欄位被更動後的反應動作
function onChangeColumn1() {
	form=document.theForm;
	index1=form.column1.selectedIndex;
	index2=form.column2.selectedIndex;
	index3=form.column3.selectedIndex;
	// Create options for column 2
	for (i=0;i<dataTree[index1].child.length;i++)
		form.column2.options[i]=new Option(dataTree[index1].child[i].name, dataTree[index1].child[i].name);
	form.column2.options.length=dataTree[index1].child.length;
	// Clear column 3
	form.column3.options.length=0;
    console.log(dataTree[index1].child.length);

}


			



</script>
</body>
</html>